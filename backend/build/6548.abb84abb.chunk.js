"use strict";(self.webpackChunkbackend=self.webpackChunkbackend||[]).push([[6548],{86548:(X,I,e)=>{e.r(I),e.d(I,{ProfilePage:()=>re});var s=e(19968),_=e(62552),y=e(3400),T=e(48112),O=e(28464),z=e(42816),k=e(35676),p=e(5e3),D=e(48936),R=e(63358),x=e(28724),c=e(70996),G=e(62492),q=e(17324),L=e(56104),d=e(16048),ee=e(53305),S=e(14032),w=e(63648),se=e(31812),ae=e(30840),$=e(21424),U=e(14632),Q=e(48632),J=e(69372),H=e(52540),u=e(10212),V=e(14134),te=e(73152),ve=e(54320),Ce=e(5240),Ae=e(91892),Ie=e(36196),Te=e(20880),Re=e(70516),xe=e(18424),Ue=e(21968),Be=e(12132),We=e(85676),Ke=e(35184),je=e(99568),ye=e(96556),Se=e(13192),we=e(77784),Qe=e(79371),He=e(67888),Ne=e(52600),Fe=e(95752),be=e(37388),ze=e(61840),Ge=e(49108),$e=e(44632),Je=e(50840),Ve=e(20252),Ze=e(86432),Ye=e(22612),Xe=e(24808),ke=e(24024),qe=e(33656),es=e(43280),ss=e(79804),as=e(19632),ts=e(29576),ns=e(61152),rs=e(9589),os=e(45488),ds=e(75516),is=e(17892),ls=e(31212);const ne=H.kt().shape({...te.C,currentPassword:H.Qb().when(["password","confirmPassword"],(t,i,r)=>t||i?r.required(d.aO.required):r),preferedLanguage:H.Qb().nullable()}),re=()=>{const t=(0,u.f)(n=>n.admin_app.language.localeNames),{setUserDisplayName:i}=(0,d.s7)(),{formatMessage:r}=(0,U.c)(),{trackUsage:a}=(0,d.m4)(),m=(0,d.eo)(),{lockApp:o,unlockApp:M}=(0,d.H6)(),{notifyStatus:F}=(0,y.O)(),v=(0,u.f)(n=>n.admin_app.theme.currentTheme),B=(0,u.l)(),{get:E,put:g}=(0,d.Qn)();(0,d.G0)();const{isLoading:le,data:C,refetch:_e}=(0,Q.useQuery)("user",async()=>{const{data:n}=await E("/admin/users/me");return n.data},{onSuccess(){F(r({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:me,data:ce}=(0,Q.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:n}}=await E("/admin/providers/isSSOLocked");return n},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){m({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),Ee=le||me,Y=(0,Q.useMutation)(async n=>{const{confirmPassword:h,currentTheme:P,...f}=n;let l=f;if((K=>"password"in K)(l)&&l.password===""){const{password:K,currentPassword:j,...b}=l;l=b}const{data:A}=await g("/admin/users/me",l);return{...A.data,currentTheme:P}},{async onSuccess(n){await _e();const{email:h,firstname:P,lastname:f,username:l,preferedLanguage:W}=n;d.cJ.setUserInfo({email:h,firstname:P,lastname:f,username:l,preferedLanguage:W});const A=n.username||(0,V.g)(n.firstname??"",n.lastname);i(A),n.preferedLanguage&&B((0,u.s)(n.preferedLanguage)),B((0,u.m)(n.currentTheme)),a("didChangeMode",{newMode:n.currentTheme}),m({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},async onSettled(){M()}}),{isLoading:Me}=Y,ge=async(n,{setErrors:h})=>{o();const P=n.username;Y.mutate({...n,username:P},{onError(f){const l=f?.response?.data;return l?.data?h(l.data):m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(Ee||!C)return(0,s.jsxs)(T.G,{"aria-busy":"true",children:[(0,s.jsx)($.S,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,s.jsx)(O.a,{title:r({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),(0,s.jsx)(z.S,{children:(0,s.jsx)(d.Wm,{})})]});const Pe=ce?.isSSOLocked??!1,{email:fe,firstname:ue,lastname:he,username:Oe,preferedLanguage:pe}=C,De={email:fe,firstname:ue,lastname:he,username:Oe,preferedLanguage:pe,currentTheme:v,confirmPassword:"",password:""};return(0,s.jsxs)(T.G,{"aria-busy":Me,children:[(0,s.jsx)($.S,{title:r({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,s.jsx)(se.QJ,{onSubmit:ge,initialValues:De,validateOnChange:!1,validationSchema:ne,enableReinitialize:!0,children:({errors:n,values:{email:h,firstname:P,lastname:f,username:l,preferedLanguage:W,currentTheme:A,...K},handleChange:j,isSubmitting:b,dirty:Le})=>(0,s.jsxs)(d.QF,{children:[(0,s.jsx)(O.a,{title:C.username||(0,V.g)(C.firstname??"",C.lastname),primaryAction:(0,s.jsx)(k.Z,{startIcon:(0,s.jsx)(ee.c,{}),loading:b,type:"submit",disabled:!Le,children:r({id:"global.save",defaultMessage:"Save"})})}),(0,s.jsx)(p.k,{paddingBottom:10,children:(0,s.jsx)(z.S,{children:(0,s.jsxs)(D.C,{direction:"column",alignItems:"stretch",gap:6,children:[(0,s.jsx)(ie,{errors:n,onChange:j,values:{firstname:P,lastname:f,username:l,email:h}}),!Pe&&(0,s.jsx)(oe,{errors:n,onChange:j,values:K}),(0,s.jsx)(de,{onChange:j,values:{preferedLanguage:W,currentTheme:A},localeNames:t})]})})})]})})]})},oe=({errors:t,onChange:i,values:r})=>{const{formatMessage:a}=(0,U.c)(),[m,o]=_.useState(!1),[M,F]=_.useState(!1),[v,B]=_.useState(!1);return(0,s.jsx)(p.k,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,s.jsxs)(D.C,{direction:"column",alignItems:"stretch",gap:4,children:[(0,s.jsx)(R.O,{variant:"delta",as:"h2",children:a({id:"global.change-password",defaultMessage:"Change password"})}),(0,s.jsx)(x.y,{gap:5,children:(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(G.g,{error:t.currentPassword?a({id:t.currentPassword,defaultMessage:t.currentPassword}):"",onChange:i,value:r.currentPassword,label:a({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:m?"text":"password",endAction:(0,s.jsx)(N,{onClick:E=>{E.stopPropagation(),o(g=>!g)},label:a(m?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:m?(0,s.jsx)(S.c,{}):(0,s.jsx)(w.c,{})})})})}),(0,s.jsxs)(x.y,{gap:5,children:[(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(Z,{error:t.password?a({id:t.password,defaultMessage:t.password}):"",onChange:i,value:r.password,label:a({id:"global.password",defaultMessage:"Password"}),name:"password",type:M?"text":"password",autoComplete:"new-password",endAction:(0,s.jsx)(N,{onClick:E=>{E.stopPropagation(),F(g=>!g)},label:a(M?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:M?(0,s.jsx)(S.c,{}):(0,s.jsx)(w.c,{})})})}),(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(Z,{error:t.confirmPassword?a({id:t.confirmPassword,defaultMessage:t.confirmPassword}):"",onChange:i,value:r.confirmPassword,label:a({id:"Auth.form.confirmPassword.label",defaultMessage:"Confirm Password"}),name:"confirmPassword",type:v?"text":"password",autoComplete:"new-password",endAction:(0,s.jsx)(N,{onClick:E=>{E.stopPropagation(),B(g=>!g)},label:a(v?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:v?(0,s.jsx)(S.c,{}):(0,s.jsx)(w.c,{})})})})]})]})})},Z=(0,J.cp)(G.g)`
  ::-ms-reveal {
    display: none;
  }
`,N=(0,J.cp)(q.d)`
  svg {
    height: ${(0,d.W8)(16)};
    width: ${(0,d.W8)(16)};
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,de=({onChange:t,values:i,localeNames:r})=>{const{formatMessage:a}=(0,U.c)(),m=(0,u.f)(o=>o.admin_app.theme.availableThemes);return(0,s.jsx)(p.k,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,s.jsxs)(D.C,{direction:"column",alignItems:"stretch",gap:4,children:[(0,s.jsxs)(D.C,{direction:"column",alignItems:"stretch",gap:1,children:[(0,s.jsx)(R.O,{variant:"delta",as:"h2",children:a({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})}),(0,s.jsx)(R.O,{children:a({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:(0,s.jsx)(p.k,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales",children:a({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"})})})})]}),(0,s.jsxs)(x.y,{gap:5,children:[(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(L.K_,{label:a({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:a({id:"global.select",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{t({target:{name:"preferedLanguage",value:null}})},clearLabel:a({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:i.preferedLanguage,onChange:o=>{t({target:{name:"preferedLanguage",value:o}})},children:Object.entries(r).map(([o,M])=>(0,s.jsx)(L.kH,{value:o,children:M},o))})}),(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsxs)(L.K_,{label:a({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:a({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:a({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:i.currentTheme,onChange:o=>{t({target:{name:"currentTheme",value:o}})},children:[(0,s.jsx)(L.kH,{value:"system",children:a({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})}),m.map(o=>(0,s.jsx)(L.kH,{value:o,children:a({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:a({id:o,defaultMessage:ae(o)})})},o))]})})]})]})})},ie=({errors:t,onChange:i,values:r})=>{const{formatMessage:a}=(0,U.c)();return(0,s.jsx)(p.k,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,s.jsxs)(D.C,{direction:"column",alignItems:"stretch",gap:4,children:[(0,s.jsx)(R.O,{variant:"delta",as:"h2",children:a({id:"global.profile",defaultMessage:"Profile"})}),(0,s.jsxs)(x.y,{gap:5,children:[(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(d.u,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:t.firstname,onChange:i,value:r.firstname,type:"text",name:"firstname",required:!0})}),(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(d.u,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:t.lastname,onChange:i,value:r.lastname,type:"text",name:"lastname"})}),(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(d.u,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:t.email,onChange:i,value:r.email,type:"email",name:"email",required:!0})}),(0,s.jsx)(c.C,{s:12,col:6,children:(0,s.jsx)(d.u,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:t.username,onChange:i,value:r.username,type:"text",name:"username"})})]})]})})}},73152:(X,I,e)=>{e.d(I,{C:()=>y});var s=e(16048),_=e(52540);const y={firstname:_.Qb().trim().required(s.aO.required),lastname:_.Qb(),email:_.Qb().email(s.aO.email).lowercase().required(s.aO.required),username:_.Qb().nullable(),password:_.Qb().min(8,s.aO.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:_.Qb().min(8,s.aO.minLength).oneOf([_.IL("password"),null],"components.Input.error.password.noMatch").when("password",(T,O)=>T?O.required(s.aO.required):O)}}}]);
